@(form: Form[Organization], org : Organization, mc_syncs : List [ MailchimpSync ],
  mc_lists : Map [ String, com.ecwid.mailchimp.method.v2_0.lists.ListMethodResult.Data ])

@main("Mailchimp Settings", menu = "crm") {


@helper.form(routes.CRM.saveMailchimpSettings()) {
	<p>Mailchimp API key:
		<input type="text" size=80 name="mailchimp_api_key", value="@org.mailchimp_api_key"/>
	<input type="submit" value="Save">
}

<hr/>
<h4>Existing MailChimp connections</h4>

<ul>
@for( sync <- mc_syncs ) {
  <li>
  When people are <b>@if(sync.sync_local_adds) {added to} else {removed from}</b>
  tag <label class="label label-success">@sync.tag.title</label>, the same change is made to MailChimp list "@mc_lists.get(sync.mailchimp_list_id).name".
  @helper.form(routes.CRM.saveMailchimpSettings(), 'style -> "display: inline") {
  <input type="hidden" name="remove_sync_id" value=@sync.id>
  <input type="submit" value="Remove">
}
</li>
}
</ul>

<hr/>
<h4>Add new MailChimp connection</h4>

@helper.form(routes.CRM.saveMailchimpSettings()) {

When people are <select name="sync_type">
	<option value="local_add">added to</option>
	<option value="local_remove">removed from</option>
		</select> tag(s) <div style="display:inline" id="tags-entered"></div><input type="text" id="tag-entry">, make the same change to MailChimp list

<select id="mailchimp_list_id" name="mailchimp_list_id">
	@mc_lists.keys.map(id =>
        Html("<option value=" + id + " >" + mc_lists.get(id).name + "</option>"))
</select>

<input type="submit" value="Add new sync rule">

<script id="tag-template" type="text/x-handlebars-template">
 <span id="tag-{{num}}" style="white-space: nowrap;"><input type=hidden name=tag_id value={{tag_id}}><span
     class="label label-success">{{name}}
    </span><a class="tag_x"><img src="/assets/images/x.png"></a>
         </span>
</script>

<script type="text/javascript">
enableNoPersonTagBox("#tag-entry", "#tags-entered", false)
</script>
}

}
