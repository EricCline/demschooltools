@(people : List[Person], person_to_stats : Map[Person, AttendanceStats],
  codes : List[String], codes_map : Map[String, AttendanceCode])

@import helper._

@main("Attendance", "attendance", "attendance_home") {


<p>View/Edit attendance for week of: <input class="date" type="textfield"></input></p>

<p><a href="">Download this year's attendance data</a></p>


<h3>Attendance Summary</h3>
<table class="table sortable">
<thead><th>Name</th>
	@for( code <- codes ) {
		<th class="attendance-code" style="background-color:@codes_map.get(code).color">
		@codes_map.get(code).description
		</th>
	}
	<th class="attendance-code">Unknown/missing code</th>
	<th>Days Present</th>
	<th>Total hours</th>
	<th>Average hours per day present</th>
	</thead>

@for( p <- people ) {
<tr><td>@p.first_name @p.last_name</td>
	@for( code <- codes ) {
		<td>@if( person_to_stats.get(p).absence_counts.containsKey(codes_map.get(code)) ) {
			@person_to_stats.get(p).absence_counts.get(codes_map.get(code))
		} else {
			0
		}</td>
	}
	<td>@if( person_to_stats.get(p).absence_counts.containsKey(null) ) {
		@person_to_stats.get(p).absence_counts.get(null)
	} else {
		0
	}</td>
	<td>@person_to_stats.get(p).days_present</td>
	<td>@person_to_stats.get(p).total_hours</td>
	<td>@(person_to_stats.get(p).total_hours / person_to_stats.get(p).days_present)</td>
}

</table>


<script type="text/javascript">
requirejs(["utils"], function(utils) {
    function dateSelected(str_date, datepicker) {
		location.href = "@routes.Attendance.viewWeek()" + "?date=" + str_date;
    }

   	$("input.date").datepicker("option", "onSelect", dateSelected);
});
</script>

}