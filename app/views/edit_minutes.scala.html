@(meeting : Meeting)

@import helper._

@main("Edit meeting minutes for date " + meeting.date, "edit_today", menu = "jc") {

<script src="@routes.Assets.at("javascripts/edit_minutes.js")" type="text/javascript"></script>

<style>
body
{
    margin-left: 310px;
}
</style>

<script type="text/javascript">
app = {}
app.cases = []
app.meeting_id = @meeting.id;
app.ROLE_JC_CHAIR = @PersonAtMeeting.ROLE_JC_CHAIR
app.ROLE_JC_MEMBER = @PersonAtMeeting.ROLE_JC_MEMBER
app.ROLE_NOTE_TAKER = @PersonAtMeeting.ROLE_NOTE_TAKER
app.ROLE_JC_SUB = @PersonAtMeeting.ROLE_JC_SUB

app.people = @Html(Application.jcPeople(""))
app.rules = @Html(Application.jsonRules(""))

app.initial_data = {
	committee : @Html(meeting.getJsonPeople(PersonAtMeeting.ROLE_JC_MEMBER)),
	chair : @Html(meeting.getJsonPeople(PersonAtMeeting.ROLE_JC_CHAIR)),
	notetaker : @Html(meeting.getJsonPeople(PersonAtMeeting.ROLE_NOTE_TAKER)),
	sub : @Html(meeting.getJsonPeople(PersonAtMeeting.ROLE_JC_SUB)),
	cases: [],
}

@for( c <- meeting.cases ) {
	app.initial_data.cases.push( @Html(c.toJson()) );
}
</script>

<div id="meeting">
</div>

<div id="sidebar">
	<h3> Click on a name to see a person's JC history.</h3>
	<h3> Click on a rule to see all people charged with that rule.</h3>
</div>

<div id="notice">
</div>

<script id="meeting-template" type="text/x-handlebars-template">
<h2>Justice Committee minutes<br>@Application.formatMeetingDate(meeting.date)</h2>
<p><a href="@routes.Application.viewMeeting(meeting.id)" class="btn btn-warning">
View printable minutes</a>
<p>Committee:
{{render "people-chooser" clazz="committee"}}
<br>Subs:
{{render "people-chooser" clazz="sub"}}
<br>Chair:
{{render "people-chooser" clazz="chair"}}
<br>Notetaker:
{{render "people-chooser" clazz="notetaker"}}

<div id="meeting-cases">
</div>

</script>

<script id="person-template" type="text/x-handlebars-template">
    <div class="name"><span class="label label-primary">{{name}}</span><img
        src="@routes.Assets.at("images/x.png")"></div>
</script>

<script id="people-chooser" type="text/x-handlebars-template">
	<div class="{{clazz}} people_chooser">
    <div class="people"></div>
  <input class="form-control person_search" type="text">
<span class="glyphicon glyphicon-user"></span>
    </div>
</script>

<script id="rule-template" type="text/x-handlebars-template">
    <div class="rule"><span class="label label-success">{{name}}</span><img
        src="@routes.Assets.at("images/x.png")"></div>
</script>

<script id="rule-chooser" type="text/x-handlebars-template">
	<div class="rule_chooser">
        <input class="form-control rule_search" type="text">
	</div>
</script>

<script id="charge-template" type="text/x-handlebars-template">
<div class="charge">
<table>
	<tr><td class="esm-form-label">Charge against:<td colspan=2>{{render "people-chooser" clazz=""}}
	<b>Entry:</b> {{> rule-chooser}}
	<tr><td class="esm-form-label">Plea:<td colspan=2>
<div class="radio-inline">
  <label><input type="radio" class="plea-guilty" value="Guilty"><span>Guilty</span></label>
</div>
<div class="radio-inline">
  <label><input type="radio" class="plea-not-guilty" value="Not Guilty"><span>Not Guilty</span></label>
</div>
&nbsp;&nbsp;&nbsp;<label><input type="checkbox" class="refer-to-sm"><span> Refer to School Meeting</span></label>
	<tr><td class="esm-form-label">Resolution plan: <td><textarea class="resolution_plan"></textarea>
    <td class="last-rp"></td>
   </table>
   <button style="margin-left: 200px" class="btn btn-danger btn-xs">Remove Charge</button>
   </div>
</script>

<script id="case-template" type="text/x-handlebars-template">
<div class="case panel panel-info">
<div class="panel-heading"><h4>Case #{{num}}</h4></div>
<div class="panel-body">

<table>
<tr><td class="esm-form-label">Who wrote complaint:
<td>{{render "people-chooser" clazz="writer"}}</tr>

<tr><td class="esm-form-label">Location: <td><input class="form-control location" type="text"></tr>
<tr><td class="esm-form-label">Date of event: <td><input class="date form-control" type="text"></tr>

<tr><td class="esm-form-label">Who testified:<td>
    {{render "people-chooser" clazz="testifier"}}
</tr>

<tr><td class="esm-form-label">Findings: <td><textarea class="findings"></textarea></tr>
</table>
<div class="charges"></div>
<button class="add-charges">Add charges</button>
</div>
</div>
</script>

<p><button onclick="javascript:addCase()">Add a case</button>


}
