import psycopg2
import sys

con = psycopg2.connect(database='school_crm', user='postgres', password='123')
cur = con.cursor()

tags = [ "C: building", "C: fundraising", "C: outreach", "calendars", "E: Assemble Mar 2013", "E: Biddle's 2/22/2013", "E: Chatham presentation", "E: Feb 2012 info night", "E: Fundraising mtg Feb 2013", "E: Hambone's 11/18/2012", "E: North Side 1/26/2013", "E: PALS Nov 2012", "E: PALS Oct 2012", "E: Pretzel Social Sep 2012", "E: South Side 2/26/2013", "Flyer Local", "General volunteering", "Interest form", "L: Pgh south", "Potential parent", "Potential staff", "Potential student",]

tags_to_tasks = {"C: building": ["Kristilee Williams", "Jessica Heathcote", "Greg Park", "Kimberly Bracken", "Lori Bower", "Sarah Banach + Eric Weber (husband)", "Jon Farinelli", ], "C: fundraising": ["Sena Jane Thompson Penberg", "Christy Valencheck", "Kimberly Bracken", "Emily Simons", "Jen Saffron", "Ben Musher", "Mary Hart", "Heather Visnesky", "Kristilee Williams", "Judy & Tony Albert", "Gil Citro", "Rachel Dingfelder", "Erok Boerer", ], "C: outreach": ["Peggy Stubbs", "Jessica Heathcote", "Kimberly DeLisio", "Kimberly Bracken", "Mary Hart", ], "calendars": [], "E: Assemble Mar 2013": ["Terese Jungle", "Jessica Heathcote", "Eric McKeegan", "Christine Dickey", "Rebecca Blackwood", "Chaim Steinberg", ], "E: Biddle's 2/22/2013": ["Brian & Megan Shope", "Sarah Bauer", "Nicki Wood", "Greg Park", "Blythe Bort", "Gay Kahkonen", "Ellen Goodman", "Jessica Burns", "Leah Herman", "Shannon Williams", "Chrissie Summa", "Kimberly DeLisio", ], "E: Chatham presentation": ["Megan Nicole", ], "E: Feb 2012 info night": ["Michelle Kirkpatrick", "Ben Musher", "Marcel Schulk", "Judy & Tony Albert", "Sheena Gibson", ], "E: Fundraising mtg Feb 2013": ["Marcin Jaroszewicz", "Agela Wiley", "Erok Boerer", "Mary Hart", "Judy & Tony Albert", "Gil Citro", "Rachel Dingfelder", "Randy Bartlett & Paige Wiegman", ], "E: Hambone's 11/18/2012": ["Michele James-Parham", "Artnoose", "Breen", ], "E: North Side 1/26/2013": ["Lauren Key Burns", "Heather Visnesky", "Mary Hart", "Lori Bower", "Kimberly Bracken", "Emily Simons", "Jen Saffron", "Ben Musher", ], "E: PALS Nov 2012": ["Elizabeth and CJ", "Alyssa", "Ahimsa Shakti", "Christy Valencheck", ], "E: PALS Oct 2012": ["Ahimsa Shakti", "Christy Valencheck", "Lawrence Wray", "AnneMarie Fireman", ], "E: Pretzel Social Sep 2012": ["Christy Valencheck", "Benjamin & Heather Shannon", "Tracy Rapport", "David Adamson", "Ben Fiorillo", "Judy & Tony Albert", "Ahimsa Shakti", "Scott Gibson", "Artnoose", "Michelle", "Sarah Banach + Eric Weber (husband)", "Brian & Megan Shope", "Brian & Mandy Wolovich", ], "E: South Side 2/26/2013": ["Jennifer Cowen", "Zachary Ramey", ], "Flyer Local": [], "General volunteering": ["Amy Piersol", "Mamatha Balasubramanian", "Megan Pinney", "Emily Simons", "Lori Howsare", "Michelle", "Kristilee Williams", "Donna Tarkett", "Patty Martinez", "Megan Nicole", ], "Interest form": ["Judy & Tony Albert", "Joy", "Kimberly Nutter", "Benjamin & Heather Shannon", "Randy Bartlett & Paige Wiegman", "Walki Preston", "Jon Farinelli", "Tracy Rapport", "Christina Frasher", "Lauren Key Burns", "Irene Yelovich", "Rachel Harvey", "David Adamson", "Nicky Snyder", "Stacey Atwell-Keister", "Patty Martinez", "Rebecca Ashkettle", "Emily Tokarczyk", "Donna Tarkett", "Kristilee Williams", "Debbie", "Michele James-Parham", "Alyssa Creasy", "Donna Mann", "Emily Harding", "Naomi Auth", "Kelly Swan", "Jessalyn Gielarowski", "Sara Beck Sweeney", "Cassi Schaffer", "Breen", "Rachel Durst", "Dana Durst", "Kara Novogradac", "Dror Yaron", "Kristan Abeshouse", "Audrey Roberto", "Julie Costa-Malcolm", "Rachel Olsen", "shannoon", "Lori Howsare", "Chad Whitco", "elizabeth smith", "Amy Wilks", "Dana Wettergreen", "Heather Visnesky", "Theresa Stadt", "Jes Sciulli", "Becky Spevack", "Roman Antopolsky", "Tavia La Follette", "Autumn Shuty", "Andrew Koller", "Nancy Gearhart", "Jonathan DiSalle", "Megan Pinney", "Mary Beth Kelly", "Bobby Finnegan", "Jessica Ruffin", "Naomi Greenberg", "Peggy Stubbs", "Jessica Heathcote", "Sarah Ferry", "Terese Jungle", "Dana Himmel", "Kristine Thomas", "Mamatha Balasubramanian", "Angela Stich", "Marie Mencher", "Carolyn Elliott", "Courtney Strauss", "Maggie Negrete", "Alejandra Placci", "Ellen Tafel", "Amy Piersol", ], "L: Pgh south": ["Jessica Ruffin", "Ben Musher", "Donna Tarkett", "Emily Tokarczyk", "Patty Martinez", "Christina Frasher", "Rachel Olsen", "Heather Visnesky", "Jes Sciulli", ], "Potential parent": ["Susan Henderson", "Cory Lynn Synan", "Chaim Steinberg", "Eric McKeegan", "Angela Stich", "Mamatha Balasubramanian", "Terese Jungle", "Naomi Greenberg", "Jessica Ruffin", "Shannon Williams", "Mary Beth Kelly", "Tavia La Follette", "Jaime Nawojski", "Becky Spevack", "Jen Saffron", "Lori Bower", "Jes Sciulli", "Heather Visnesky", "Dana Wettergreen", "Amy Wilks", "elizabeth smith", "Lori Howsare", "shannoon", "Rachel Olsen", "Julie Costa-Malcolm", "Kristan Abeshouse", "Kara Novogradac", "Rachel Durst", "Breen", "Cassi Schaffer", "Sara Beck Sweeney", "Jessalyn Gielarowski", "Elizabeth and CJ", "Alyssa", "Emily Harding", "Donna Mann", "Alyssa Creasy", "Michele James-Parham", "Kristilee Williams", "Katie and Bob Ketcham", "Donna Tarkett", "Christy Valencheck", "Ahimsa Shakti", "Brian & Megan Shope", "Emily Tokarczyk", "Rebecca Ashkettle", "Debbie Ganchuk", "Patty Martinez", "Stacey Atwell-Keister", "Vanessa Manz", "Rachel Harvey", "Irene Yelovich", "Lauren Key Burns", "Tracy Rapport", "Joy", "Benjamin & Heather Shannon", "Randy Bartlett & Paige Wiegman", ], "Potential staff": ["Alejandra Placci", "Maggie Negrete", "Courtney Strauss", "Marie Mencher", "Kristine Thomas", "Terese Jungle", "Jessica Heathcote", "Naomi Greenberg", "Bobby Finnegan", "Seth Ringold", "Mary Beth Kelly", "Jonathan DiSalle", "Megan Pinney", "Nancy Gearhart", "Andrew Koller", "Autumn Shuty", "Chad Whitco", "Lori Howsare", "Audrey Roberto", "Breen", "Sara Beck Sweeney", "Kelly Swan", "Michele James-Parham", "Marcel Schulk", "Christina Frasher", "Stacey Atwell-Keister", "David Adamson", "Rachel Harvey", "Tracy Rapport", "Benjamin & Heather Shannon", "Randy Bartlett & Paige Wiegman", ], "Potential student": ["Angela Stich", "Terese Jungle", "elizabeth smith", "Kristan Abeshouse", "Rachel Durst", "Kelly Swan", "Debbie", "Vanessa Manz", "Nicky Snyder", "Christina Frasher", ] }

for t in tags:
    cur.execute("INSERT INTO tag (title) VALUES (%s)", [t])
    cur.execute("SELECT id from tag where title = %s", [t])
    id = cur.fetchone()

    for person in tags_to_tasks[t]:
        cur.execute("SELECT person_id from person where first_name=%s", [person])
        person_id = cur.fetchone()

        cur.execute("INSERT INTO person_tag (tag_id, person_id, creator_id) VALUES (%s, %s, 1)",
            [id, person_id])

con.commit()
